<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Product List</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
          integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>
          <link rel="stylesheet" th:href="@{/css/productList.css}">
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
</head>
<body>
    <th:block th:insert="~{fragments/header.html}"/>
    <div class="container">
        <div th:if="${itemsByCategory != null and #lists.size(itemsByCategory) > 0}">
            <div class="collection_product_list">
                <div th:each="item,itemIndex: ${itemsByCategory}" class="featured_product">
                    <div class="featured_product_inner">
                    
                        <a th:href="@{'/itempage?id=' + ${item.itemId}}" class="product_item_image">
                            <div class="ratio">
                                <img th:src="@{'/images/' + ${itemImages[itemIndex.index][0].imagePath}}" alt=""/>
                    
                            </div>
                        </a>
                        <div class="product_item_info">
                            <div class="product_item_info_inner">
                           
                                <a th:href="@{'/itempage?id=' + ${item.itemId}}" class="product_title" th:text="${item.itemTitle}"></a>
                         
                                <div class="product_item_price">
                                    <span class="price" th:text="'EGP ' + ${item.itemPrice}"></span>
                                    
                                    <form th:action="@{/cart/add}"   method="POST" id="cart-form" >
                                        <input type="hidden" name="itemId" th:value="${item.itemId}" >
                                        <button class="add_to_bag_btn">Add to Bag</button>
                                    </form>

                                </div>
                            </div>
                            <!-- <div th:if="${username != null}">
                                <button class="add_to_bag_btn">Add to Bag</button>
                            </div> -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <th:block th:if="${itemsByCategory == null or #lists.size(itemsByCategory) == 0}">
            <p>No items available in this category</p>
        </th:block>

        <div class="popup" style="display: none;">
            <button class="close-popup"><i class='bx bx-x'></i></button>
            <p>Product added to cart!</p>
           
        </div>
    </div>
    <th:block th:insert="~{fragments/footer.html}"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script th:src="@{/js/cart.js}"></script>
</body>
</html>